(function(e){var t=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global;if(typeof define==="function"&&define.amd){define([],function(){return t.Backendless=e(t)})}else if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=t.Backendless=e(t)}else{t.Backendless=e(t)}})(function(root){"use strict";var NodeDevice={name:"NODEJS",platform:"NODEJS",uuid:"someId",version:"1"};var isBrowser=new Function("try {return this===window;}catch(e){ return false;}")();var previousBackendless=root.Backendless;var Backendless={},emptyFn=function(){};Backendless.VERSION="3.1.5";Backendless.serverURL="https://api.backendless.com";Backendless.noConflict=function(){root.Backendless=previousBackendless;return this};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e,t){var n;if(this==null){throw new TypeError('"this" is null or not defined')}var s=Object(this);var r=s.length>>>0;if(r===0){return-1}var a=+t||0;if(Math.abs(a)===Infinity){a=0}if(a>=r){return-1}n=Math.max(a>=0?a:r-Math.abs(a),0);while(n<r){if(n in s&&s[n]===e){return n}n++}return-1}}var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var slice=ArrayProto.slice,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var WebSocket=null;initXHR();var browser=function(){var e=isBrowser?navigator.userAgent.toLowerCase():"NodeJS",t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n={browser:t[1]||"",version:t[2]||"0"},s={};if(n.browser){s[n.browser]=true;s.version=n.version}return s}();var UIState=null;var getNow=function(){return(new Date).getTime()};var promisesEnabled=false;Backendless.browser=browser;Backendless.enablePromises=enablePromises;Backendless.promisesEnabled=function(){return promisesEnabled};var Utils=Backendless.Utils={isObject:function(e){return e===Object(e)},isString:function(e){return Object.prototype.toString.call(e).slice(8,-1)==="String"},isNumber:function(e){return Object.prototype.toString.call(e).slice(8,-1)==="Number"},isFunction:function(e){return Object.prototype.toString.call(e).slice(8,-1)==="Function"},isBoolean:function(e){return Object.prototype.toString.call(e).slice(8,-1)==="Boolean"},isDate:function(e){return Object.prototype.toString.call(e).slice(8,-1)==="Date"}};Utils.isArray=nativeIsArray||function(e){return Object.prototype.toString.call(e).slice(8,-1)==="Array"};Utils.addEvent=function(e,t,n){if(t.addEventListener){t.addEventListener(e,n,false)}else if(t.attachEvent){t.attachEvent("on"+e,n)}else{t[e]=n}};Utils.isEmpty=function(e){if(e==null){return true}if(Utils.isArray(e)||Utils.isString(e)){return e.length===0}for(var t in e){if(e.hasOwnProperty(t)&&e[t]!==undefined&&e[t]!==null){return false}}return true};Utils.removeEvent=function(e,t){if(t.removeEventListener){t.removeEventListener(e,null,false)}else if(t.detachEvent){t.detachEvent("on"+e,null)}else{t[e]=null}};function initXHR(){try{if(typeof XMLHttpRequest.prototype.sendAsBinary=="undefined"){XMLHttpRequest.prototype.sendAsBinary=function(e){var t=new ArrayBuffer(e.length);var n=new Uint8Array(t,0);for(var s=0;s<e.length;s++){n[s]=e.charCodeAt(s)&255}this.send(n)}}}catch(e){}}function tryParseJSON(e){try{return typeof e==="string"?JSON.parse(e):e}catch(t){return e}}Backendless.setUIState=function(e){if(e===undefined){throw new Error("UI state name must be defined or explicitly set to null")}else{UIState=e===null?null:e}};Backendless._ajax_for_browser=function(e){var t=["cacheOnly","remoteDataOnly","fromCacheOrRemote","fromRemoteOrCache","fromCacheAndRemote"],n={ignoreCache:function(e){return s(e)},cacheOnly:function(e){var t=Backendless.LocalCache.get(e.url.replace(/([^A-Za-z0-9])/g,"")),n={message:"error: cannot find data in Backendless.LocalCache",statusCode:404};if(t){e.isAsync&&e.asyncHandler.success(t);return t}else{if(e.isAsync){e.asyncHandler.fault(n)}else{throw n}}},remoteDataOnly:function(e){return s(e)},fromCacheOrRemote:function(e){var t=Backendless.LocalCache.get(e.url.replace(/([^A-Za-z0-9])/g,""));if(t){e.isAsync&&e.asyncHandler.success(t);return t}else{return s(e)}},fromRemoteOrCache:function(e){return s(e)},fromCacheAndRemote:function(e){var t={},n=Backendless.LocalCache.get(e.url.replace(/([^A-Za-z0-9])/g,"")),r={message:"error: cannot find data in Backendless.LocalCache",statusCode:404};t.remote=s(e);if(n){e.isAsync&&e.asyncHandler.success(n);t.local=n}else{if(e.isAsync){e.asyncHandler.fault(r)}else{throw r}}return t}},s=function(e){var t=new XMLHttpRequest,n=e.data?"application/json":"application/x-www-form-urlencoded",s;var r=function(e){var t=true;if(e.responseText){t=tryParseJSON(e.responseText)}return t};var a=function(e){var t={};try{t=JSON.parse(e.responseText)}catch(n){t.message=e.responseText}t.statusCode=e.status;t.message=t.message||"unknown error occurred";return t};var i=function(t){t=cloneObject(t);if(e.method=="GET"&&e.cacheActive){t.cachePolicy=e.cachePolicy;Backendless.LocalCache.set(e.urlBlueprint,t)}else if(Backendless.LocalCache.exists(e.urlBlueprint)){if(t===true||e.method=="DELETE"){t=undefined}else{t.cachePolicy=Backendless.LocalCache.getCachePolicy(e.urlBlueprint)}"___class"in t&&delete t["___class"];Backendless.LocalCache.set(e.urlBlueprint,t)}};var o=function(){return e.cacheActive&&e.cachePolicy.policy=="fromRemoteOrCache"&&Backendless.LocalCache.exists(e.urlBlueprint)};t.open(e.method,e.url,e.isAsync);t.setRequestHeader("Content-Type",n);t.setRequestHeader("application-id",Backendless.applicationId);t.setRequestHeader("secret-key",Backendless.secretKey);t.setRequestHeader("application-type","JS");if(currentUser!=null&&currentUser["user-token"]){t.setRequestHeader("user-token",currentUser["user-token"])}else if(Backendless.LocalCache.exists("user-token")){t.setRequestHeader("user-token",Backendless.LocalCache.get("user-token"))}if(UIState!==null){t.setRequestHeader("uiState",UIState)}if(e.isAsync){t.onreadystatechange=function(){if(t.readyState==4){if(t.status>=200&&t.status<300){s=r(t);i(s);e.asyncHandler.success&&e.asyncHandler.success(s)}else if(o()){e.asyncHandler.success&&e.asyncHandler.success(Backendless.LocalCache.get(e.urlBlueprint))}else{e.asyncHandler.fault&&e.asyncHandler.fault(a(t))}}}}t.send(e.data);if(e.isAsync){return t}else if(t.status>=200&&t.status<300){s=r(t);i(s);return s}else if(o()){return Backendless.LocalCache.get(e.urlBlueprint)}else{throw a(t)}};e.method=e.method||"GET";e.cachePolicy=e.cachePolicy||{policy:"ignoreCache"};e.isAsync=typeof e.isAsync=="boolean"?e.isAsync:false;e.cacheActive=e.method=="GET"&&t.indexOf(e.cachePolicy.policy)!=-1;e.urlBlueprint=e.url.replace(/([^A-Za-z0-9])/g,"");try{return n[e.cachePolicy.policy].call(this,e)}catch(r){throw r}};Backendless._ajax_for_nodejs=function(e){e.data=e.data||"";if(typeof e.data!=="string"){e.data=JSON.stringify(e.data)}e.asyncHandler=e.asyncHandler||{};e.isAsync=typeof e.isAsync=="boolean"?e.isAsync:false;var t=e.url.substr(0,e.url.indexOf("/",8)).substr(0,e.url.indexOf(":"));var n=e.url.substr(0,e.url.indexOf("/",8)).substr(e.url.indexOf("/")+2),s=n.substr(0,n.indexOf(":")==-1?n.length:n.indexOf(":")),r=n.indexOf(":")!=-1?parseInt(n.substr(n.indexOf(":")+1)):t=="http"?80:443;var a={host:s,port:r,method:e.method||"GET",path:e.url.substr(e.url.indexOf("/",8)),headers:{"Content-Length":e.data?Buffer.byteLength(e.data):0,"Content-Type":e.data?"application/json":"application/x-www-form-urlencoded","application-id":Backendless.applicationId,"secret-key":Backendless.secretKey,"application-type":"JS"}};var i="";if(currentUser!=null&&!!currentUser["user-token"]){a.headers["user-token"]=currentUser["user-token"]}if(!e.isAsync){throw new Error("Use Async type of request using Backendless with NodeJS. Add Backendless.Async(successCallback, errorCallback) as last argument")}var o=require(t);var c=o.request(a,function(t){t.setEncoding("utf8");t.on("data",function(e){i+=e});t.on("end",function(){var n=t.headers["content-type"];if(n&&n.indexOf("application/json")!==-1){i=tryParseJSON(i)}var s=e.asyncHandler[t.statusCode>=200&&t.statusCode<300?"success":"fault"];if(Utils.isFunction(s)){s(i)}})});c.on("error",function(t){e.asyncHandler.fault||(e.asyncHandler.fault=function(){});e.asyncHandler.fault(t)});c.write(e.data);return c.end()};Backendless._ajax=isBrowser?Backendless._ajax_for_browser:Backendless._ajax_for_nodejs;var getClassName=function(){if(this.prototype&&this.prototype.___class){return this.prototype.___class}if(Utils.isFunction(this)&&this.name){return this.name}var e=Utils.isFunction(this)?this.toString():this.constructor.toString(),t=e.match(/function\s+(\w+)/);return t&&t.length>1?t[1]:""};var encodeArrayToUriComponent=function(e){var t=[],n,s;for(n=0,s=e.length;n<s;++n){t.push(encodeURIComponent(e[n]))}return t.join(",")};var classWrapper=function(obj){var wrapper=function(obj){var wrapperName=null,Wrapper=null;for(var property in obj){if(obj.hasOwnProperty(property)){if(property==="___class"){wrapperName=obj[property];break}}}if(wrapperName){try{Wrapper=eval(wrapperName);obj=deepExtend(new Wrapper,obj)}catch(e){}}return obj};if(Utils.isObject(obj)&&obj!=null){if(Utils.isArray(obj)){for(var i=obj.length;i--;){obj[i]=wrapper(obj[i])}}else{obj=wrapper(obj)}}return obj};var deepExtend=function(e,t){for(var n in t){if(t[n]!==undefined&&t.hasOwnProperty(n)){e[n]=e[n]||{};e[n]=classWrapper(t[n]);if(e[n]&&e[n].hasOwnProperty(n)&&e[n][n]&&e[n][n].hasOwnProperty("__originSubID")){e[n][n]=classWrapper(e[n])}}}return e};var cloneObject=function(e){return Utils.isArray(e)?e.slice():deepExtend({},e)};var extractResponder=function(e){var t,n;for(t=0,n=e.length;t<n;++t){if(e[t]instanceof Async){return e[t]}}return null};function extendCollection(e,t){if(e.nextPage!=null){if(e.nextPage&&e.nextPage.split("/")[1]==Backendless.appVersion){e.nextPage=Backendless.serverURL+e.nextPage}e._nextPage=e.nextPage;e.nextPage=function(e){return t._load(this._nextPage,e)};if(promisesEnabled){e.nextPage=promisify(e.nextPage)}e.getPage=function(e,n,s){var r=this._nextPage.replace(/offset=\d+/gi,"offset="+e);if(!(n instanceof Async)){r=r.replace(/pagesize=\d+/gi,"pageSize="+n)}s=extractResponder(arguments);return t._load(r,s)};e.dataMapper=t}}function Async(e,t,n){if(!(t instanceof Function)){n=t;t=emptyFn}this.success=function(t){e&&e.call(n,t)};this.fault=function(e){t&&t.call(n,e)}}function setCache(){var e={},t="localStorage",n;e.enabled=false;e.exists=function(e){};e.set=function(e,t){};e.get=function(e){};e.remove=function(e){};e.clear=function(){};e.flushExpired=function(){};e.getCachePolicy=function(e){};e.getAll=function(){};e.serialize=function(e){return JSON.stringify(e)};e.deserialize=function(e){if(typeof e!="string"){return undefined}try{return JSON.parse(e)}catch(t){return e||undefined}};function s(){try{if(isBrowser&&(t in window&&window[t])){localStorage.setItem("localStorageTest",true);localStorage.removeItem("localStorageTest");return true}else{return false}}catch(e){return false}}if(s()){n=window[t];var r=function(){if(!("Backendless"in n)){n.setItem("Backendless",e.serialize({}))}};var a=function(e){var t=false;if(Object.prototype.toString.call(e).slice(8,-1)=="Object"){if("cachePolicy"in e&&"timeToLive"in e["cachePolicy"]&&e["cachePolicy"]["timeToLive"]!=-1&&"created"in e["cachePolicy"]){t=(new Date).getTime()-e["cachePolicy"]["created"]>e["cachePolicy"]["timeToLive"]}}return t};var i=function(e){if(Object.prototype.toString.call(e).slice(8,-1)=="Object"){if("cachePolicy"in e&&"timeToLive"in e["cachePolicy"]){e["cachePolicy"]["created"]=(new Date).getTime()}}};r();e.enabled=true;e.exists=function(t){return e.get(t)!==undefined};e.set=function(t,s){if(s===undefined){return e.remove(t)}r();var a=e.deserialize(n.getItem("Backendless"));i(s);a[t]=s;try{n.setItem("Backendless",e.serialize(a))}catch(o){a={};a[t]=s;n.setItem("Backendless",e.serialize(a))}return s};e.get=function(t){r();var s=e.deserialize(n.getItem("Backendless")),i=s[t],o=i;if(a(i)){delete s[t];n.setItem("Backendless",e.serialize(s));o=undefined}if(o&&o["cachePolicy"]){delete o["cachePolicy"]}return o};e.remove=function(t){var s;r();t=t.replace(/([^A-Za-z0-9-])/g,"");var a=e.deserialize(n.getItem("Backendless"));if(a.hasOwnProperty(t)){s=delete a[t]}n.setItem("Backendless",e.serialize(a));return s};e.clear=function(){n.setItem("Backendless",e.serialize({}))};e.getAll=function(){r();var t=e.deserialize(n.getItem("Backendless"));var s={};for(var a in t){if(t.hasOwnProperty(a)){s[a]=t[a];if(s[a]!==null&&s[a].hasOwnProperty("cachePolicy")){delete s[a]["cachePolicy"]}}}return s};e.flushExpired=function(){r();var t=e.deserialize(n.getItem("Backendless")),s;for(var i in t){if(t.hasOwnProperty(i)){s=t[i];if(a(s)){delete t[i];n.setItem("Backendless",e.serialize(t))}}}};e.getCachePolicy=function(t){r();var s=e.deserialize(n.getItem("Backendless"));var a=s[t];return a?a["cachePolicy"]:undefined}}return e}Backendless.LocalCache=setCache();if(Backendless.LocalCache.enabled){Backendless.LocalCache.flushExpired()}Backendless.Async=Async;function DataStore(e){this.model=Utils.isString(e)?function(){}:e;this.className=getClassName.call(e);if((typeof e).toLowerCase()==="string"){this.className=e}if(!this.className){throw"Class name should be specified"}this.restUrl=Backendless.appPath+"/data/"+this.className}DataStore.prototype={_extractQueryOptions:function(e){var t=[];if(typeof e.pageSize!="undefined"){if(e.pageSize<1||e.pageSize>100){throw new Error("PageSize can not be less then 1 or greater than 100")}t.push("pageSize="+encodeURIComponent(e.pageSize))}if(typeof e.offset!="undefined"){if(e.offset<0){throw new Error("Offset can not be less then 0")}t.push("offset="+encodeURIComponent(e.offset))}if(e.sortBy){if(Utils.isString(e.sortBy)){t.push("sortBy="+encodeURIComponent(e.sortBy))}else if(Utils.isArray(e.sortBy)){t.push("sortBy="+encodeArrayToUriComponent(e.sortBy))}}if(e.relationsDepth){if(Utils.isNumber(e.relationsDepth)){t.push("relationsDepth="+Math.floor(e.relationsDepth))}}if(e.relations){if(Utils.isArray(e.relations)){t.push("loadRelations="+(e.relations.length?encodeArrayToUriComponent(e.relations):"*"))}}return t.join("&")},_wrapAsync:function(e){var t=this;var n=function(n){n=t._parseResponse(n);e.success(n)};var s=function(t){e.fault(t)};return new Async(n,s)},_wrapFindAsync:function(e){var t=this;var n=function(n){n=t._parseFindResponse(n);e.success(n)};var s=function(t){e.fault(t)};return new Async(n,s)},_parseResponse:function(e){var t=this.model,n;e=e.fields||e;n=new t;extendCollection(e,this);deepExtend(n,e);return this._formCircDeps(n)},_parseFindResponse:function(e){var t,n,s=this.model,r;if(e.data){var a=e,i=a.data;for(t=0,n=i.length;t<n;++t){i[t]=i[t].fields||i[t];r=new s;deepExtend(r,i[t]);i[t]=r}extendCollection(a,this);return this._formCircDeps(a)}else{e=e.fields||e;r=Utils.isString(s)?{}:new s;deepExtend(r,e);return this._formCircDeps(r)}},_load:function(e,t){if(e){var n=extractResponder(arguments),s=false;if(n!=null){s=true;n=this._wrapAsync(n)}var r=Backendless._ajax({method:"GET",url:e,isAsync:s,asyncHandler:n});return s?r:this._parseResponse(r)}},_replCircDeps:function(e){var t=[e];var n;var s=function(){for(var e="",t=e;t++<36;e+=t*51&&52?(t^15?8^Math.random()*(t^20?16:4):4).toString(16):"-"){}return e};var r=function(e){for(var a in e){if(e.hasOwnProperty(a)&&typeof e[a]=="object"&&e[a]!=null){if((n=t.indexOf(e[a]))!=-1){t[n]["__subID"]=t[n]["__subID"]||s();e[a]={__originSubID:t[n]["__subID"]}}else if(Utils.isDate(e[a])){e[a]=e[a].getTime()}else{t.push(e[a]);r(e[a])}}}};r(e)},_formCircDeps:function(e){var t={},n=new e.constructor,s=function(e,n){if(e.hasOwnProperty("__subID")){t[e["__subID"]]=n;delete e["__subID"]}for(var r in e){if(e.hasOwnProperty(r)){if(typeof e[r]=="object"&&e[r]!=null){if(e[r].hasOwnProperty("__originSubID")){n[r]=t[e[r]["__originSubID"]]}else{n[r]=new e[r].constructor;s(e[r],n[r])}}else{n[r]=e[r]}}}};s(e,n);return n},save:function(e,t){this._replCircDeps(e);var n=extractResponder(arguments),s=false,r="PUT",a=this.restUrl,i=e;if(n!=null){s=true;n=this._wrapAsync(n)}var o=Backendless._ajax({method:r,url:a,data:JSON.stringify(e),isAsync:s,asyncHandler:n});if(!s){deepExtend(i,this._parseResponse(o))}return s?o:i},remove:function(e,t){if(!Utils.isObject(e)&&!Utils.isString(e)){throw new Error('Invalid value for the "value" argument. The argument must contain only string or object values')}var n=extractResponder(arguments),s=false;if(n!=null){s=true;n=this._wrapAsync(n)}var r;if(Utils.isString(e)||e.objectId){e=e.objectId||e;r=Backendless._ajax({method:"DELETE",url:this.restUrl+"/"+e,isAsync:s,asyncHandler:n})}else{r=Backendless._ajax({method:"DELETE",url:this.restUrl,data:JSON.stringify(e),isAsync:s,asyncHandler:n})}return s?r:this._parseResponse(r)},find:function(e){e=e||{};var t,n,s,r=[],a=this.restUrl,i=extractResponder(arguments),o=i!=null,c;if(e.properties&&e.properties.length){t="props="+encodeArrayToUriComponent(e.properties)}if(e.condition){n="where="+encodeURIComponent(e.condition)}if(e.options){s=this._extractQueryOptions(e.options)}i!=null&&(i=this._wrapFindAsync(i));s&&r.push(s);n&&r.push(n);t&&r.push(t);r=r.join("&");if(e.url){a+="/"+e.url}if(r){a+="?"+r}c=Backendless._ajax({method:"GET",url:a,isAsync:o,asyncHandler:i,cachePolicy:e.cachePolicy});return o?c:this._parseFindResponse(c)},_buildArgsObject:function(){var e={},t=arguments.length,n="";for(;t--;){n=Object.prototype.toString.call(arguments[t]).toLowerCase().match(/[a-z]+/g)[1];switch(n){case"number":e.options=e.options||{};e.options.relationsDepth=arguments[t];break;case"string":e.url=arguments[t];break;case"array":e.options=e.options||{};e.options.relations=arguments[t];break;case"object":if(arguments[t].hasOwnProperty("cachePolicy")){e.cachePolicy=arguments[t]["cachePolicy"]}break;default:break}}return e},findById:function(){var e;if(Utils.isString(arguments[0])){e=this._buildArgsObject.apply(this,arguments);if(!e.url){throw new Error('missing argument "object ID" for method findById()')}return this.find.apply(this,[e].concat(Array.prototype.slice.call(arguments)))}else if(Utils.isObject(arguments[0])){e=arguments[0];var t=extractResponder(arguments),n=this.restUrl,s=t!=null,r="/pk?";for(var a in e){r+=a+"="+e[a]+"&"}t!=null&&(t=this._wrapAsync(t));var i;if(getClassName.call(arguments[0])=="Object"){i=Backendless._ajax({method:"GET",url:n+r.replace(/&$/,""),isAsync:s,asyncHandler:t})}else{i=Backendless._ajax({method:"PUT",url:n,data:JSON.stringify(e),isAsync:s,asyncHandler:t})}return s?i:this._parseResponse(i)}else{throw new Error('Invalid value for the "value" argument. The argument must contain only string or object values')}},loadRelations:function(e){if(!e){throw new Error("missing object argument for method loadRelations()")}if(!Utils.isObject(e)){throw new Error('Invalid value for the "value" argument. The argument must contain only object values')}var t=arguments[0];var n=this.restUrl+"/relations";if(arguments[1]){if(Utils.isArray(arguments[1])){if(arguments[1][0]=="*"){n+="?relationsDepth="+arguments[1].length}else{n+="?loadRelations="+arguments[1][0]+"&relationsDepth="+arguments[1].length}}else{throw new Error('Invalid value for the "options" argument. The argument must contain only array values')}}var s=Backendless._ajax({method:"PUT",url:n,data:JSON.stringify(t)});deepExtend(e,s)},findFirst:function(){var e=this._buildArgsObject.apply(this,arguments);e.url="first";return this.find.apply(this,[e].concat(Array.prototype.slice.call(arguments)))},findLast:function(){var e=this._buildArgsObject.apply(this,arguments);e.url="last";return this.find.apply(this,[e].concat(Array.prototype.slice.call(arguments)))}};var dataStoreCache={};var persistence={save:function(e,t,n){var s=extractResponder(arguments),r=false;if(Utils.isString(e)){var a=Backendless.appPath+"/data/"+e;return Backendless._ajax({method:"POST",url:a,data:JSON.stringify(t),isAsync:r,asyncHandler:s})}if(Utils.isObject(e)){return new DataStore(e).save(e,t,n)}},getView:function(e,t,n,s,r){var a=extractResponder(arguments),i=a!=null;if(Utils.isString(e)){var o=Backendless.appPath+"/data/"+e;if(arguments.length>1&&!(arguments[1]instanceof Backendless.Async)){o+="?"}if(Utils.isString(t)){o+="where="+t}else{n=t;s=n}if(Utils.isNumber(n)){o+="&"+(new DataStore)._extractQueryOptions({pageSize:n})}if(Utils.isNumber(s)){o+="&"+(new DataStore)._extractQueryOptions({offset:s})}return Backendless._ajax({method:"GET",url:o,isAsync:i,asyncHandler:a})}else{throw new Error("View name is required string parameter")}},callStoredProcedure:function(e,t,n){var s=extractResponder(arguments),r=s!=null;if(Utils.isString(e)){var a=Backendless.appPath+"/data/"+e,i={};if(Utils.isObject(t)){i=JSON.stringify(t)}return Backendless._ajax({method:"POST",url:a,data:i,isAsync:r,asyncHandler:s})}else{throw new Error("Stored Procedure name is required string parameter")}},of:function(e){var t;if(Utils.isString(e)){if(e.toLowerCase()==="users"){throw new Error("Table 'Users' is not accessible through this signature. Use Backendless.Data.of( BackendlessUser.class ) instead")}t=e}else{t=getClassName.call(e)}var n=dataStoreCache[t];if(!n){n=new DataStore(e);dataStoreCache[t]=n}return n},describe:function(e,t){e=Utils.isString(e)?e:getClassName.call(e);var n=extractResponder(arguments),s=n!=null;return Backendless._ajax({method:"GET",url:Backendless.appPath+"/data/"+e+"/properties",isAsync:s,asyncHandler:n})}};function DataPermissions(){this.restUrl=Backendless.appPath+"/data";this.getRestUrl=function(e,t){return this.restUrl+"/"+encodeURIComponent(e.___class)+"/permissions/"+encodeURIComponent(t)+"/"+encodeURIComponent(e.objectId)};this.sendRequest=function(e,t,n,s,r,a){var i=extractResponder(arguments),o=i!=null,c={permission:s};if(!n.___class||!n.objectId){throw new Error('"dataObject.___class" and "dataObject.objectId" need to be specified')}if(e){c.user=e}else if(t){c.role=t}return Backendless._ajax({method:"PUT",url:this.getRestUrl(n,r),data:JSON.stringify(c),isAsync:o,asyncHandler:i})}}DataPermissions.prototype={FIND:{grantUser:function(e,t,n){return Backendless.Data.Permissions.sendRequest(e,null,t,"FIND","GRANT",n)},grantRole:function(e,t,n){return Backendless.Data.Permissions.sendRequest(null,e,t,"FIND","GRANT",n)},grant:function(e,t){return Backendless.Data.Permissions.sendRequest("*",null,e,"FIND","GRANT",t)},denyUser:function(e,t,n){return Backendless.Data.Permissions.sendRequest(e,null,t,"FIND","DENY",n)},denyRole:function(e,t,n){return Backendless.Data.Permissions.sendRequest(null,e,t,"FIND","DENY",n)},deny:function(e,t){return Backendless.Data.Permissions.sendRequest("*",null,e,"FIND","DENY",t)}},REMOVE:{grantUser:function(e,t,n){return Backendless.Data.Permissions.sendRequest(e,null,t,"REMOVE","GRANT",n)},grantRole:function(e,t,n){return Backendless.Data.Permissions.sendRequest(null,e,t,"REMOVE","GRANT",n)},grant:function(e,t){return Backendless.Data.Permissions.sendRequest("*",null,e,"REMOVE","GRANT",t)},denyUser:function(e,t,n){return Backendless.Data.Permissions.sendRequest(e,null,t,"REMOVE","DENY",n)},denyRole:function(e,t,n){return Backendless.Data.Permissions.sendRequest(null,e,t,"REMOVE","DENY",n)},deny:function(e,t){return Backendless.Data.Permissions.sendRequest("*",null,e,"REMOVE","DENY",t)}},UPDATE:{grantUser:function(e,t,n){return Backendless.Data.Permissions.sendRequest(e,null,t,"UPDATE","GRANT",n)},grantRole:function(e,t,n){return Backendless.Data.Permissions.sendRequest(null,e,t,"UPDATE","GRANT",n)},grant:function(e,t){return Backendless.Data.Permissions.sendRequest("*",null,e,"UPDATE","GRANT",t)},denyUser:function(e,t,n){return Backendless.Data.Permissions.sendRequest(e,null,t,"UPDATE","DENY",n)},denyRole:function(e,t,n){return Backendless.Data.Permissions.sendRequest(null,e,t,"UPDATE","DENY",n)},deny:function(e,t){return Backendless.Data.Permissions.sendRequest("*",null,e,"UPDATE","DENY",t)}}};function User(){}User.prototype.___class="Users";Backendless.User=User;var currentUser=null;var UserService=function(){this.restUrl=Backendless.appPath+"/users"};UserService.prototype={_wrapAsync:function(e){var t=this,n=function(n){currentUser=t._parseResponse(tryParseJSON(n));e.success(t._getUserFromResponse(currentUser))},s=function(t){e.fault(t)};return new Async(n,s)},_parseResponse:function(e){var t=new Backendless.User;deepExtend(t,e);return t},register:function(e,t){if(!(e instanceof Backendless.User)){throw new Error("Only Backendless.User accepted")}var n=extractResponder(arguments);var s=n!=null;if(n){n=this._wrapAsync(n)}var r=Backendless._ajax({method:"POST",url:this.restUrl+"/register",isAsync:s,asyncHandler:n,data:JSON.stringify(e)});return s?r:this._parseResponse(r)},getUserRoles:function(e){var t=extractResponder(arguments);var n=t!=null;if(t){t=this._wrapAsync(t)}var s=Backendless._ajax({method:"GET",url:this.restUrl+"/userroles",isAsync:n,asyncHandler:t});return n?s:this._parseResponse(s)},roleHelper:function(e,t,n,s){if(!e){throw new Error("Username can not be empty")}if(!t){throw new Error("Rolename can not be empty")}var r=extractResponder(arguments);var a=r!=null;if(r){r=this._wrapAsync(r)}var i={user:e,roleName:t};return Backendless._ajax({method:"POST",url:this.restUrl+"/"+s,isAsync:a,asyncHandler:r,data:JSON.stringify(i)})},assignRole:function(e,t,n){return this.roleHelper(e,t,n,"assignRole")},unassignRole:function(e,t,n){return this.roleHelper(e,t,n,"unassignRole")},login:function(e,t,n,s){if(!e){throw new Error("Username can not be empty")}if(!t){throw new Error("Password can not be empty")}Backendless.LocalCache.remove("user-token");Backendless.LocalCache.remove("current-user-id");Backendless.LocalCache.set("stayLoggedIn",false);if(Utils.isBoolean(n)){Backendless.LocalCache.set("stayLoggedIn",n)}var r=extractResponder(arguments);var a=r!=null;if(r){r=this._wrapAsync(r)}var i={login:e,password:t};var o=Backendless._ajax({method:"POST",url:this.restUrl+"/login",isAsync:a,asyncHandler:r,data:JSON.stringify(i)});if(a){return o}currentUser=this._parseResponse(o);return this._getUserFromResponse(currentUser)},_getUserFromResponse:function(e){Backendless.LocalCache.set("current-user-id",e.objectId);var t=new Backendless.User;for(var n in e){if(e.hasOwnProperty(n)){if(n=="user-token"){if(Backendless.LocalCache.get("stayLoggedIn")){Backendless.LocalCache.set("user-token",e[n])}continue}t[n]=e[n]}}return t},loggedInUser:function(){return Backendless.LocalCache.get("current-user-id")},describeUserClass:function(e){var t=extractResponder(arguments);var n=t!=null;return Backendless._ajax({method:"GET",url:this.restUrl+"/userclassprops",isAsync:n,asyncHandler:t})},restorePassword:function(e,t){if(!e){throw"Username can not be empty"}var n=extractResponder(arguments);var s=n!=null;return Backendless._ajax({method:"GET",url:this.restUrl+"/restorepassword/"+encodeURIComponent(e),isAsync:s,asyncHandler:n})},logout:function(e){var t=extractResponder(arguments),n=t!=null,s=n?t.fault:null,r=n?t.success:null,a={},i=function(){Backendless.LocalCache.remove("user-token");Backendless.LocalCache.remove("current-user-id");Backendless.LocalCache.remove("stayLoggedIn");currentUser=null},o=function(){i();if(Utils.isFunction(r)){r()}},c=function(e){if(Utils.isObject(e)&&[3064,3091,3090,3023].indexOf(e.code)!=-1){i()}if(Utils.isFunction(s)){s(e)}};if(t){t.fault=c;t.success=o}try{a=Backendless._ajax({method:"GET",url:this.restUrl+"/logout",isAsync:n,asyncHandler:t})}catch(l){c(l)}if(n){return a}else{i()}},getCurrentUser:function(){if(currentUser){return this._getUserFromResponse(currentUser)}else if(Backendless.LocalCache.get("stayLoggedIn")){var e=Backendless.LocalCache.get("current-user-id");return Backendless.Data.of(Backendless.User).findById(e)}else{return null}},update:function(e,t){var n=extractResponder(arguments);var s=n!=null;if(n){n=this._wrapAsync(n)}var r=Backendless._ajax({method:"PUT",url:this.restUrl+"/"+e.objectId,isAsync:s,asyncHandler:n,data:JSON.stringify(e)});return s?r:this._parseResponse(r)},loginWithFacebook:function(e,t,n,s,r){this._loginSocial("Facebook",e,t,n,s,r)},loginWithGooglePlus:function(e,t,n,s,r){this._loginSocial("GooglePlus",e,t,n,s,r)},loginWithTwitter:function(e,t,n){this._loginSocial("Twitter",e,null,t,null,n)},_socialContainer:function(e,t){var n;if(t){var s;t=t[0];n=document.createElement("div");n.innerHTML="Loading...";t.appendChild(n);t.style.cursor="wait";this.closeContainer=function(){t.style.cursor="default";t.removeChild(s)};this.removeLoading=function(){t.removeChild(n)};this.doAuthorizationActivity=function(e){this.removeLoading();s=document.createElement("iframe");s.frameBorder=0;s.width=t.style.width;s.height=t.style.height;s.id="SocialAuthFrame";s.setAttribute("src",e+"&amp;output=embed");t.appendChild(s);s.onload=function(){t.style.cursor="default"}}}else{t=window.open("",e+" authorization","height=250,width=450,scrollbars=0,toolbar=0,menubar=0,location=0,resizable=0,status=0,titlebar=0",false);n=t.document.getElementsByTagName("body")[0].innerHTML;n="Loading...";t.document.getElementsByTagName("html")[0].style.cursor="wait";this.closeContainer=function(){t.close()};this.removeLoading=function(){n=null};this.doAuthorizationActivity=function(e){t.location.href=e;t.onload=function(){t.document.getElementsByTagName("html")[0].style.cursor="default"}}}},_loginSocial:function(e,t,n,s,r,a){var i=new this._socialContainer(e,r);Backendless.LocalCache.set("stayLoggedIn",!!a);var o=extractResponder(arguments);if(o){o=this._wrapAsync(o)}Utils.addEvent("message",window,function(e){if(e.origin==Backendless.serverURL){var t=JSON.parse(e.data);if(t.fault){o.fault(t.fault)}else{currentUser=this.Backendless.UserService._parseResponse(t);o.success(this.Backendless.UserService._getUserFromResponse(currentUser))}Utils.removeEvent("message",window);i.closeContainer()}});var c=new Backendless.Async(function(e){i.doAuthorizationActivity(e)},function(e){i.closeContainer();o.fault(e)});var l=t||n?{}:null;if(t){l.fieldsMapping=t}if(n){l.permissions=n}Backendless._ajax({method:"POST",url:this.restUrl+"/social/oauth/"+e.toLowerCase()+"/request_url",isAsync:true,asyncHandler:c,data:JSON.stringify(l)})},loginWithFacebookSdk:function(e,t,n){if(!FB){throw new Error("Facebook SDK not found")}if(t instanceof Async){n=t;t=false}var s=this;FB.getLoginStatus(function(r){if(r.status==="connected"){s._sendSocialLoginRequest(s,r,"facebook",e,t,n)}else{FB.login(function(r){s._sendSocialLoginRequest(s,r,"facebook",e,t,n)})}})},loginWithGooglePlusSdk:function(e,t,n){if(!gapi){throw new Error("Google Plus SDK not found")}if(t instanceof Async){n=t;t=false}var s=this;gapi.auth.authorize({client_id:e.client_id,scope:"https://www.googleapis.com/auth/plus.login"},function(r){delete r["g-oauth-window"];s._sendSocialLoginRequest(s,r,"googleplus",e,t,n)})},_sendSocialLoginRequest:function(e,t,n,s,r,a){if(s){t["fieldsMapping"]=s}var i=new Backendless.Async(function(t){currentUser=e._parseResponse(t);Backendless.LocalCache.set("stayLoggedIn",!!r);a.success(e._getUserFromResponse(currentUser))},function(e){a.fault(e)});Backendless._ajax({method:"POST",url:e.restUrl+"/social/"+n+"/login/"+Backendless.applicationId,isAsync:true,asyncHandler:i,data:JSON.stringify(t)})},isValidLogin:function(e){var t=Backendless.LocalCache.get("user-token");var n=extractResponder(arguments);var s=n!=null;if(n){n=this._wrapAsync(n)}if(t){if(!e){try{var r=Backendless._ajax({method:"GET",url:Backendless.serverURL+"/"+Backendless.appVersion+"/users/isvalidusertoken/"+t});return!!r;

}catch(a){return false}}else{Backendless._ajax({method:"GET",url:Backendless.serverURL+"/"+Backendless.appVersion+"/users/isvalidusertoken/"+t,isAsync:s,asyncHandler:n})}}else{var i=Backendless.UserService.getCurrentUser();return!!i}}};function Geo(){this.restUrl=Backendless.appPath+"/geo";this.monitoringId=null}Geo.prototype={UNITS:{METERS:"METERS",KILOMETERS:"KILOMETERS",MILES:"MILES",YARDS:"YARDS",FEET:"FEET"},_wrapAsync:function(e){var t=this,n=function(n){n=t._parseResponse(n);e.success(n)},s=function(t){e.fault(t)};return new Async(n,s)},_parseResponse:function(e){var t=e.collection;extendCollection(t,this);return t},_load:function(e,t){var n=extractResponder(arguments),s=n!=null;var r=Backendless._ajax({method:"GET",url:e,isAsync:s,asyncHandler:n});return s?r:this._parseResponse(r)},_findHelpers:{searchRectangle:function(e){var t=["nwlat="+e[0],"nwlon="+e[1],"selat="+e[2],"selon="+e[3]];return t.join("&")},latitude:function(e){return"lat="+e},longitude:function(e){return"lon="+e},metadata:function(e){return"metadata="+JSON.stringify(e)},units:function(e){return"units="+e},radius:function(e){return"r="+e},categories:function(e){e=Utils.isString(e)?[e]:e;return"categories="+encodeArrayToUriComponent(e)},includeMetadata:function(e){return"includemetadata="+e},pageSize:function(e){if(e<1||e>100){throw new Error("PageSize can not be less then 1 or greater than 100")}else{return"pagesize="+e}},offset:function(e){if(e<0){throw new Error("Offset can not be less then 0")}else{return"offset="+e}},relativeFindPercentThreshold:function(e){if(e<=0){throw new Error("Threshold can not be less then or equal 0")}else{return"relativeFindPercentThreshold="+e}},relativeFindMetadata:function(e){return"relativeFindMetadata="+encodeURIComponent(JSON.stringify(e))},condition:function(e){return"whereClause="+encodeURIComponent(e)},degreePerPixel:function(e){return"dpp="+e},clusterGridSize:function(e){return"clustergridsize="+e},geoFence:function(e){return"geoFence="+e}},addPoint:function(e,t){if(e.latitude===undefined||e.longitude===undefined){throw"Latitude or longitude not a number"}e.categories=e.categories||["Default"];e.categories=Utils.isArray(e.categories)?e.categories:[e.categories];var n=extractResponder(arguments);var s=n!=null;var r=function(e){var t=function(t){var n=t.geopoint;var s=new GeoPoint;s.categories=n.categories;s.latitude=n.latitude;s.longitude=n.longitude;s.metadata=n.metadata;s.objectId=n.objectId;t.geopoint=s;e.success(t)};var n=function(t){e.fault(t)};return new Async(t,n)};n=r(n);return Backendless._ajax({method:"PUT",url:this.restUrl+"/points",data:JSON.stringify(e),isAsync:s,asyncHandler:n})},findUtil:function(e,t){var n=e["url"],s=extractResponder(arguments),r=false;if(e.searchRectangle&&e.radius){throw new Error("Inconsistent geo query. Query should not contain both rectangle and radius search parameters.")}else if(e.radius&&(e.latitude===undefined||e.longitude===undefined)){throw new Error("Latitude and longitude should be provided to search in radius")}else if((e.relativeFindMetadata||e.relativeFindPercentThreshold)&&!(e.relativeFindMetadata&&e.relativeFindPercentThreshold)){throw new Error("Inconsistent geo query. Query should contain both relativeFindPercentThreshold and relativeFindMetadata or none of them")}else{n+=e.searchRectangle?"/rect?":"/points?";n+=e.units?"units="+e.units:"";for(var a in e){if(e.hasOwnProperty(a)&&this._findHelpers.hasOwnProperty(a)&&e[a]!=null){n+="&"+this._findHelpers[a](e[a])}}}n=n.replace(/\?&/g,"?");var i=this;var o=function(t){var n=function(n){var s=n.collection.data;for(var r=0;r<s.length;r++){var a=null;if(s[r].hasOwnProperty("totalPoints")){a=new GeoCluster;a.totalPoints=s[r].totalPoints;a.geoQuery=e}else{a=new GeoPoint}a.categories=s[r].categories;a.latitude=s[r].latitude;a.longitude=s[r].longitude;a.metadata=s[r].metadata;a.objectId=s[r].objectId;a.distance=s[r].distance;n.collection.data[r]=a}n=i._parseResponse(n);t.success(n)};var s=function(e){t.fault(e)};return new Async(n,s)};if(s!=null){r=true}s=o(s);var c=Backendless._ajax({method:"GET",url:n,isAsync:r,asyncHandler:s});return r?c:this._parseResponse(c)},find:function(e,t){e["url"]=this.restUrl;return this.findUtil(e,t)},loadMetadata:function(e,t){var n=this.restUrl+"/points/",s=extractResponder(arguments),r=false;if(e.objectId){if(e instanceof GeoCluster){if(e.geoQuery instanceof GeoQuery){n+=e.objectId+"/metadata?";for(var a in e.geoQuery){if(e.geoQuery.hasOwnProperty(a)&&this._findHelpers.hasOwnProperty(a)&&e.geoQuery[a]!=null){n+="&"+this._findHelpers[a](e.geoQuery[a])}}}else{throw new Error("Invalid GeoCluster object. Make sure to obtain an instance of GeoCluster using the Backendless.Geo.find API")}}else if(e instanceof GeoPoint){n+=e.objectId+"/metadata"}else{throw new Error("Method argument must be a valid instance of GeoPoint or GeoCluster persisted on the server")}}else{throw new Error("Method argument must be a valid instance of GeoPoint or GeoCluster persisted on the server")}if(s!=null){r=true}return Backendless._ajax({method:"GET",url:n,isAsync:r,asyncHandler:s})},getClusterPoints:function(e,t){var n=this.restUrl+"/clusters/",s=extractResponder(arguments),r=false;if(e.objectId){if(e instanceof GeoCluster){if(e.geoQuery instanceof GeoQuery){n+=e.objectId+"/points?";for(var a in e.geoQuery){if(e.geoQuery.hasOwnProperty(a)&&this._findHelpers.hasOwnProperty(a)&&e.geoQuery[a]!=null){n+="&"+this._findHelpers[a](e.geoQuery[a])}}}else{throw new Error("Invalid GeoCluster object. Make sure to obtain an instance of GeoCluster using the Backendless.Geo.find API")}}else{throw new Error("Method argument must be a valid instance of GeoCluster persisted on the server")}}else{throw new Error("Method argument must be a valid instance of GeoCluster persisted on the server")}var i=this;var o=function(e){var t=function(t){var n=t.collection.data;for(var s=0;s<n.length;s++){var r=null;r=new GeoPoint;r.categories=n[s].categories;r.latitude=n[s].latitude;r.longitude=n[s].longitude;r.metadata=n[s].metadata;r.objectId=n[s].objectId;t.collection.data[s]=r}t=i._parseResponse(t);e.success(t)};var n=function(t){e.fault(t)};return new Async(t,n)};if(s!=null){r=true}s=o(s);var c=Backendless._ajax({method:"GET",url:n,isAsync:r,asyncHandler:s});return r?c:this._parseResponse(c)},relativeFind:function(e,t){if(!(e.relativeFindMetadata&&e.relativeFindPercentThreshold)){throw new Error("Inconsistent geo query. Query should contain both relativeFindPercentThreshold and relativeFindMetadata")}else{e["url"]=this.restUrl+"/relative";return this.findUtil(e,t)}},addCategory:function(e,t){if(!e){throw new Error("Category name is required.")}var n=extractResponder(arguments);var s=n!=null;var r=Backendless._ajax({method:"PUT",url:this.restUrl+"/categories/"+e,isAsync:s,asyncHandler:n});return typeof r.result==="undefined"?r:r.result},getCategories:function(e){var t=extractResponder(arguments);var n=t!=null;return Backendless._ajax({method:"GET",url:this.restUrl+"/categories",isAsync:n,asyncHandler:t})},deleteCategory:function(e,t){if(!e){throw new Error("Category name is required.")}var n=extractResponder(arguments);var s=n!=null;var r={};try{r=Backendless._ajax({method:"DELETE",url:this.restUrl+"/categories/"+e,isAsync:s,asyncHandler:n})}catch(a){if(a.statusCode==404){r=false}else{throw a}}return typeof r.result==="undefined"?r:r.result},deletePoint:function(e,t){if(!e||Utils.isFunction(e)){throw new Error("Point argument name is required, must be string (object Id), or point object")}var n=Utils.isString(e)?e:e.objectId,s=extractResponder(arguments),r=s!=null,a={};try{a=Backendless._ajax({method:"DELETE",url:this.restUrl+"/points/"+n,isAsync:r,asyncHandler:s})}catch(i){if(i.statusCode==404){a=false}else{throw i}}return typeof a.result==="undefined"?a:a.result},getFencePoints:function(e,t,n){t=t||new GeoQuery;if(!Utils.isString(e)){throw new Error("Invalid value for parameter 'geoFenceName'. Geo Fence Name must be a String")}if(!(t instanceof GeoQuery)){throw new Error("Invalid geo query. Query should be instance of Backendless.GeoQuery")}t["geoFence"]=e;t["url"]=this.restUrl;return this.findUtil(t,n)},_runFenceAction:function(e,t,n,s){if(!Utils.isString(t)){throw new Error("Invalid value for parameter 'geoFenceName'. Geo Fence Name must be a String")}if(n&&!(n instanceof Backendless.Async)&&!(n instanceof GeoPoint)&&!n.objectId){throw new Error("Method argument must be a valid instance of GeoPoint persisted on the server")}var r=extractResponder(arguments),a=r!=null,i={method:"POST",url:this.restUrl+"/fence/"+e+"?geoFence="+t,isAsync:a,asyncHandler:r};if(n){i.data=JSON.stringify(n)}return Backendless._ajax(i)},runOnStayAction:function(e,t,n){return this._runFenceAction("onstay",e,t,n)},runOnExitAction:function(e,t,n){return this._runFenceAction("onexit",e,t,n)},runOnEnterAction:function(e,t,n){return this._runFenceAction("onenter",e,t,n)},_getFences:function(e){return Backendless._ajax({method:"GET",url:this.restUrl+"/fences"+(e?"?geoFence="+e:"")})},EARTH_RADIUS:6378100,_distance:function(e,t,n,s){var r=t-s;r=r*Math.PI/180;e=e*Math.PI/180;n=n*Math.PI/180;return this.EARTH_RADIUS*Math.acos(Math.sin(e)*Math.sin(n)+Math.cos(e)*Math.cos(n)*Math.cos(r))},_updateDegree:function(e){e+=180;while(e<0){e+=360}return e===0?180:e%360-180},_countLittleRadius:function(e){var t=Math.abs(e)/180*this.EARTH_RADIUS;var n=2*this.EARTH_RADIUS;var s=(Math.pow(n,2)-n*Math.sqrt(Math.pow(n,2)-4*Math.pow(t,2)))/2;return n/2-Math.sqrt(s-Math.pow(t,2))},_isDefiniteRect:function(e,t){return e!=null&&t!=null},_getOutRectangle:function(){return arguments.length==1?this._getOutRectangleNodes(arguments[1]):this._getOutRectangleCircle(arguments[0],arguments[1])},_getOutRectangleCircle:function(e,t){var n=this._distance(e.latitude,e.longitude,t.latitude,t.longitude);var s=e.latitude+180*n/(Math.PI*this.EARTH_RADIUS)*(e.latitude>0?1:-1);var r=this._countLittleRadius(s);var a,i,o,c;if(r>n){a=e.longitude-180*n/r;i=2*e.longitude-a;a=this._updateDegree(a);i=i%360==180?180:this._updateDegree(i)}else{a=-180;i=180}if(e.latitude>0){o=s;c=2*e.latitude-s}else{c=s;o=2*e.latitude-s}return[Math.min(o,90),a,Math.max(c,-90),i]},_getOutRectangleNodes:function(e){var t=e[0].latitude;var n=e[0].longitude;var s=e[0].latitude;var r=e[0].longitude;var a=0,i=0,o=0;for(var c=1;c<e.length;c++){if(e[c].latitude>t){t=e[c].latitude}if(e[c].latitude<s){s=e[c].latitude}var l=e[c].latitude-e[c-1].latitude;if(l<0&&l>-180||l>270){if(l>270){l-=360}o+=l;if(o<a){a=o}}else if(l>0&&l<=180||l<=-270){if(l<=-270){l+=360}o+=l;if(o>i){i=o}}}n+=a;r+=i;if(r-n>=360){r=180;n=-180}else{r=this._updateDegree(r);n=this._updateDegree(n)}return[t,n,s,r]},_getPointPosition:function(e,t,n){var s=n.longitude-t.longitude;if(s<0&&s>-180||s>180){var r=t;t=n;n=r}if(e.latitude<t.latitude==e.latitude<n.latitude){return"NO_INTERSECT"}var a=e.longitude-t.longitude;if(a<0&&a>-180||a>180){a=(a-360)%360}var i=(n.longitude-t.longitude+360)%360;var o=i*(e.latitude-t.latitude)/(n.latitude-t.latitude)-a;if(o>0){return"INTERSECT"}return"NO_INTERSECT"},_isPointInRectangular:function(e,t,n){if(e.latitude>t.latitude||e.latitude<n.latitude){return false}if(t.longitude>n.longitude){return e.longitude>=t.longitude||e.longitude<=n.longitude}else{return e.longitude>=t.longitude&&e.longitude<=n.longitude}},_isPointInCircle:function(e,t,n){return this._distance(e.latitude,e.longitude,t.latitude,t.longitude)<=n},_isPointInShape:function(e,t){var n=0;function s(e,t){return(e+1)%t.length}for(var r=0;r<t.length;r++){var a=this._getPointPosition(e,t[r],t[s(r,t)]);switch(a){case"INTERSECT":{n++;break}case"ON_LINE":case"NO_INTERSECT":default:break}}return n%2==1},_isPointInFence:function(e,t){return this._isPointInRectangular(e,t.nwPoint,t.sePoint)||t.type=="CIRCLE"&&this._isPointInCircle(e,t.nodes[0],this._distance(t.nodes[0].latitude,t.nodes[0].longitude,t.nodes[1].latitude,t.nodes[1].longitude))||t.type=="SHAPE"&&this._isPointInShape(e,t.nodes)},_typesMapper:{RECT:function(e){e.nwPoint=e.nodes[0];e.sePoint=e.nodes[1]},CIRCLE:function(e,t){var n=t._getOutRectangle(e.nodes[0],e.nodes[1]);e.nwPoint={latitude:n[0],longitude:n[1]};e.sePoint={latitude:n[2],longitude:n[3]}},SHAPE:function(e,t){var n=t._getOutRectangle(e.nodes[0],e.nodes[1]);e.nwPoint={latitude:n[0],longitude:n[1]};e.sePoint={latitude:n[2],longitude:n[3]}}},_maxDuration:5e3,_timers:{},_checkPosition:function(e,t,n,s,r,a,i){var o=this;for(var c=0;c<o._trackedFences.length;c++){var l=o._isDefiniteRect(o._trackedFences[c].nwPoint,o._trackedFences[c].sePoint)&&o._isPointInFence(t,o._trackedFences[c]);var u=null;if(l!=a[o._trackedFences[c].geofenceName]){if(a[o._trackedFences[c].geofenceName]){u="onexit"}else{u="onenter"}a[o._trackedFences[c].geofenceName]=l}if(u){var d=o._trackedFences[c].onStayDuration*1e3,f=function(e,t,n){var s=function(){r["onstay"](o._trackedFences[e].geofenceName,o._trackedFences[e].objectId,t.latitude,t.longitude)};o._timers[o._trackedFences[e].geofenceName]=setTimeout(s,n)},h=function(e,t,n,s){var r=function(){o._runFenceAction("onstay",o._trackedFences[e].geofenceName,s,i)};o._timers[o._trackedFences[e].geofenceName]=setTimeout(r,n)};if(r){if(u=="onenter"){r[u](o._trackedFences[c].geofenceName,o._trackedFences[c].objectId,t.latitude,t.longitude);if(d>-1){(function(e,t,n){return f(e,t,n)})(c,t,d)}else{r["onstay"](o._trackedFences[c].geofenceName,o._trackedFences[c].objectId,t.latitude,t.longitude)}}else{clearTimeout(o._timers[o._trackedFences[c].geofenceName]);r[u](o._trackedFences[c].geofenceName,o._trackedFences[c].objectId,t.latitude,t.longitude)}}else if(s){s.latitude=t.latitude;s.longitude=t.longitude;if(u=="onenter"){o._runFenceAction(u,o._trackedFences[c].geofenceName,s,i);if(d>-1){(function(e,t,n,s){return h(e,t,n,s)})(c,t,d,s)}else{o._runFenceAction("onstay",o._trackedFences[c].geofenceName,s,i)}}else{clearTimeout(o._timers[o._trackedFences[c].geofenceName]);o._runFenceAction(u,o._trackedFences[c].geofenceName,s,i)}}}}},_mobilecheck:function(){var e=false;(function(t){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))){e=true}})(navigator.userAgent||navigator.vendor||window.opera);return e},_trackedFences:[],_lastResults:{},_startMonitoring:function(e,t,n){var s=this;var r=false;if(t instanceof GeoPoint){r=true}var a=this._getFences(e);for(var i=0;i<a.length;i++){if(!o(s._trackedFences,a[i],"geofenceName")){s._typesMapper[a[i].type](a[i],s);s._lastResults[a[i].geofenceName]=false;s._trackedFences.push(a[i])}else{}}function o(e,t,n){var s=e.length,r=false;for(var a=0;a<s;a++){if(r=e[a][n]===t[n]){break}}return r}function c(i){s._checkPosition(e,i.coords,a,r?t:null,!r?t:null,s._lastResults,n)}function l(e){throw new Error("Error during current position calculation. Error "+e.message)}function u(){navigator.geolocation.getCurrentPosition(c,l,{timeout:5e3,enableHighAccuracy:true})}if(!this.monitoringId){if(a.length){this.monitoringId=!this._mobilecheck()?setInterval(u,s._maxDuration):navigator.geolocation.watchPosition(c,l,{timeout:s._maxDuration,enableHighAccuracy:true})}else{throw new Error("Please, add some fences to start monitoring")}}},startGeofenceMonitoringWithInAppCallback:function(e,t,n){this._startMonitoring(e,t,n)},startGeofenceMonitoringWithRemoteCallback:function(e,t,n){this._startMonitoring(e,t,n)},stopGeofenceMonitoring:function(e){var t=this;if(e){for(var n=0;n<t._trackedFences.length;n++){if(t._trackedFences[n].geofenceName==e){t._trackedFences.splice(n,1);delete t._lastResults[e]}}}else{this._lastResuls={};this._trackedFences=[]}if(!t._trackedFences.length){t.monitoringId=null;!t._mobilecheck()?clearInterval(t.monitoringId):navigator.geolocation.clearWatch(t.monitoringId)}}};function Proxy(){}Proxy.prototype={on:function(e,t){if(!e){throw new Error("Event name not specified")}if(!t){throw new Error("Handler not specified")}this.eventHandlers[e]=this.eventHandlers[e]||[];this.eventHandlers[e].push(t)},fireEvent:function(e,t){var n=this.eventHandlers[e]||[],s,r;for(r=0,s=n.length;r<s;++r){n[r](t)}}};function PollingProxy(e){this.eventHandlers={};this.restUrl=e;this.timer=0;this.timeout=0;this.interval=1e3;this.xhr=null;this.needReconnect=true;this.responder=new Async(this.onMessage,this.onError,this);this.poll()}PollingProxy.prototype=new Proxy;deepExtend(PollingProxy.prototype,{onMessage:function(e){clearTimeout(this.timeout);var t=this;this.timer=setTimeout(function(){t.poll()},this.interval);this.fireEvent("messageReceived",e)},poll:function(){var e=this;this.timeout=setTimeout(function(){e.onTimeout()},30*1e3);this.xhr=Backendless._ajax({method:"GET",url:this.restUrl,isAsync:true,asyncHandler:this.responder})},close:function(){clearTimeout(this.timer);clearTimeout(this.timeout);this.needReconnect=false;this.xhr&&this.xhr.abort()},onTimeout:function(){this.xhr&&this.xhr.abort()},onError:function(){clearTimeout(this.timer);clearTimeout(this.timeout);if(this.needReconnect){var e=this;this.xhr=null;this.timer=setTimeout(function(){e.poll()},this.interval)}}});function SocketProxy(e){var t=this;this.reconnectWithPolling=true;try{var n=this.socket=new WebSocket(e);n.onopen=function(){return t.sockOpen()};n.onerror=function(e){return t.sockError(e)};n.onclose=function(){t.onSocketClose()};n.onmessage=function(e){return t.onMessage(e)}}catch(s){setTimeout(function(){t.onSocketClose()},100)}}SocketProxy.prototype=new Proxy;deepExtend(SocketProxy.prototype,{onMessage:function(){this.fireEvent("messageReceived",data)},onSocketClose:function(e){if(this.reconnectWithPolling){this.fireEvent("socketClose",e)}},close:function(){this.reconnectWithPolling=false;this.socket.close()}});function Subscription(e){this.channelName=e.channelName;this.options=e.options;this.channelProperties=e.channelProperties;this.subscriptionId=null;this.restUrl=e.restUrl+"/"+e.channelName;this.responder=e.responder||emptyFn;this._subscribe(e.onSubscribe)}Subscription.prototype={_subscribe:function(e){var t=extractResponder(arguments);var n=t!=null;var s=this;var r=new Async(function(e){s.subscriptionId=e.subscriptionId;s._startSubscription()},function(e){t.fault(e)});var a=Backendless._ajax({method:"POST",url:this.restUrl+"/subscribe",isAsync:n,data:JSON.stringify(this.options),asyncHandler:r});if(!n){this.subscriptionId=a.subscriptionId;this._startSubscription()}},_startSubscription:function(){var e=this;if(WebSocket){var t=this.channelProperties["websocket"]+"/"+this.subscriptionId;this.proxy=new SocketProxy(t);this.proxy.on("socketClose",function(){e._switchToPolling()});this.proxy.on("messageReceived",function(){e.responder()})}else{this._switchToPolling()}this._startSubscription=emptyFn},cancelSubscription:function(){this.proxy&&this.proxy.close();this._startSubscription=emptyFn},_switchToPolling:function(){var e=this.restUrl+"/"+this.subscriptionId;this.proxy=new PollingProxy(e);var t=this;this.proxy.on("messageReceived",function(e){if(e.messages.length){t.responder(e)}})}};function Messaging(){this.restUrl=Backendless.appPath+"/messaging";this.channelProperties={}}Messaging.prototype={_getProperties:function(e,t){var n=extractResponder(arguments);var s=n!=null;var r=this.channelProperties[e];if(r){if(s){t.success(r)}return r}var a=Backendless._ajax({method:"GET",url:this.restUrl+"/"+e+"/properties",isAsync:s,asyncHandler:n});this.channelProperties[e]=a;return a},subscribe:function(e,t,n,s){var r=extractResponder(arguments);var a=r!=null;if(a){var i=this;var o=new Async(function(a){s.success(new Subscription({channelName:e,options:n,channelProperties:a,responder:t,restUrl:i.restUrl,onSubscribe:r}))},function(e){r.fault(e)});this._getProperties(e,o)}else{var c=this._getProperties(e);return new Subscription({channelName:e,options:n,channelProperties:c,responder:t,restUrl:this.restUrl})}},publish:function(e,t,n,s,r){var a=extractResponder(arguments);var i=a!=null;var o={message:t};if(n){if(!(n instanceof PublishOptions)){throw"Use PublishOption as publishOptions argument"}deepExtend(o,n)}if(s){if(!(s instanceof DeliveryOptions)){throw"Use DeliveryOptions as deliveryTarget argument"}deepExtend(o,s)}return Backendless._ajax({method:"POST",url:this.restUrl+"/"+e,isAsync:i,asyncHandler:a,data:JSON.stringify(o)})},sendEmail:function(e,t,n,s,r){var a=extractResponder(arguments);var i=a!=null;var o={};if(e&&!Utils.isEmpty(e)&&Utils.isString(e)){o.subject=e}else{throw"Subject is required parameter and must be a nonempty string"}if(t instanceof Bodyparts&&!Utils.isEmpty(t)){o.bodyparts=t}else{throw"Use Bodyparts as bodyParts argument, must contain at least one property"}if(n&&Utils.isArray(n)&&!Utils.isEmpty(n)){o.to=n}else{throw"Recipients is required parameter, must be a nonempty array"}if(s){if(Utils.isArray(s)){if(!Utils.isEmpty(s)){o.attachment=s}}else{throw"Attachments must be an array of file IDs from File Service"}}return Backendless._ajax({method:"POST",url:this.restUrl+"/email",isAsync:i,asyncHandler:a,data:JSON.stringify(o)})},cancel:function(e,t){var n=t!=null;return Backendless._ajax({method:"DELETE",url:this.restUrl+"/"+e,isAsync:n,asyncHandler:new Async(emptyFn)})},registerDevice:function(e,t,n){var s=extractResponder(arguments);var r=s!=null;var a=isBrowser?window.device:NodeDevice;var i={deviceToken:null,deviceId:a.uuid,os:a.platform,osVersion:a.version};if(Utils.isArray(e)){i.channels=e}for(var o=0,c=arguments.length;o<c;++o){var l=arguments[o];if(Utils.isNumber(l)||l instanceof Date){i.expiration=l instanceof Date?l.getTime()/1e3:l}}var u=this.restUrl+"/registrations";var d=function(e){i.deviceToken=e;Backendless._ajax({method:"POST",url:u,data:JSON.stringify(i),isAsync:r,asyncHandler:s})};var f=function(e){console.warn(JSON.stringify(["failed to register ",e]))};var h={projectid:"http://backendless.com",appid:Backendless.applicationId};cordova.exec(d,f,"PushNotification","registerDevice",[h])},getRegistrations:function(e){var t=isBrowser?window.device.uuid:NodeDevice.uuid;var n=extractResponder(arguments);var s=n!=null;return Backendless._ajax({method:"GET",url:this.restUrl+"/registrations/"+t,isAsync:s,asyncHandler:n})},unregisterDevice:function(e){var t=isBrowser?window.device.uuid:NodeDevice.uuid;var n=extractResponder(arguments);var s=n!=null;var r=Backendless._ajax({method:"DELETE",url:this.restUrl+"/registrations/"+t,isAsync:s,asyncHandler:n});try{cordova.exec(emptyFn,emptyFn,"PushNotification","unregisterDevice",[])}catch(a){console.log(a.message)}return r}};function getBuilder(e,t,n){var s="--",r="\r\n",a="";a+=s;a+=n;a+=r;a+='Content-Disposition: form-data; name="file"';a+='; filename="'+e+'"';a+=r;a+="Content-Type: application/octet-stream";a+=r;a+=r;a+=t;a+=r;a+=s;a+=n;a+=s;a+=r;return a}function send(e){var t=new XMLHttpRequest,n="-backendless-multipart-form-boundary-"+getNow(),s=getBuilder(this.fileName,e.target.result,n),r=function(e){var t={};try{t=JSON.parse(e.responseText)}catch(n){t.message=e.responseText}t.statusCode=e.status;return t};t.open("POST",this.uploadPath,true);t.setRequestHeader("content-type","multipart/form-data; boundary="+n);t.setRequestHeader("application-id",Backendless.applicationId);t.setRequestHeader("secret-key",Backendless.secretKey);t.setRequestHeader("application-type","JS");if(currentUser!=null&&currentUser["user-token"]){t.setRequestHeader("user-token",currentUser["user-token"])}else if(Backendless.LocalCache.exists("user-token")){t.setRequestHeader("user-token",Backendless.LocalCache.get("user-token"))}if(UIState!==null){t.setRequestHeader("uiState",UIState)}var a=this.asyncHandler;if(a){t.onreadystatechange=function(){if(t.readyState==4){if(t.status>=200&&t.status<300){a.success(JSON.parse(t.responseText))}else{a.fault(JSON.parse(t.responseText))}}}}t.sendAsBinary(s);if(a){return t}if(t.status>=200&&t.status<300){return t.responseText?JSON.parse(t.responseText):true}else{throw r(t)}}function sendEncoded(e){var t=new XMLHttpRequest,n="-backendless-multipart-form-boundary-"+getNow(),s=function(e){var t={};try{t=JSON.parse(e.responseText)}catch(n){t.message=e.responseText}t.statusCode=e.status;return t};t.open("PUT",this.uploadPath,true);t.setRequestHeader("Content-Type","text/plain");t.setRequestHeader("application-id",Backendless.applicationId);t.setRequestHeader("secret-key",Backendless.secretKey);t.setRequestHeader("application-type","JS");if(UIState!==null){t.setRequestHeader("uiState",UIState)}var r=this.asyncHandler;if(r){t.onreadystatechange=function(){if(t.readyState==4){if(t.status>=200&&t.status<300){r.success(JSON.parse(t.responseText))}else{r.fault(JSON.parse(t.responseText))}}}}t.send(e.target.result.split(",")[1]);if(r){return t}if(t.status>=200&&t.status<300){return t.responseText?JSON.parse(t.responseText):true}else{throw s(t)}}function FilePermissions(){this.restUrl=Backendless.appPath+"/files/permissions"}FilePermissions.prototype={grantUser:function(e,t,n,s){this.varType="user";this.id=e;return this.grant(t,n,s)},grantRole:function(e,t,n,s){this.varType="role";this.id=e;return this.grant(t,n,s)},grant:function(e,t,n){return this.sendRequest("GRANT",e,t,n)},denyUser:function(e,t,n,s){this.varType="role";this.id=e;return this.deny(t,n,s)},denyRole:function(e,t,n,s){this.varType="role";this.id=e;return this.deny(t,n,s)},deny:function(e,t,n){return this.sendRequest("DENY",e,t,n)},sendRequest:function(e,t,n,s){var r=extractResponder(arguments),a=r!=null,i={permission:n};i[this.varType]=this.id||"*";return Backendless._ajax({method:"PUT",url:this.restUrl+"/"+e+"/"+encodeURIComponent(t),data:JSON.stringify(i),isAsync:a,asyncHandler:r})}};function Files(){this.restUrl=Backendless.appPath+"/files"}Files.prototype={saveFile:function(e,t,n,s,r){if(!e||!Utils.isString(e)){throw new Error('Missing value for the "path" argument. The argument must contain a string value')}if(!t||!Utils.isString(e)){throw new Error('Missing value for the "fileName" argument. The argument must contain a string value')}if(s instanceof Backendless.Async){r=s;s=null}if(!(n instanceof File)){n=new Blob([n])}if(n.size>28e5){throw new Error("File Content size must be less than 2,800,000 bytes")}var a=this.restUrl+"/binary/"+e+(Utils.isString(t)?"/"+t:"")+(s?"?overwrite=true":"");try{var i=new FileReader;i.fileName=encodeURIComponent(t).replace(/'/g,"%27").replace(/"/g,"%22");i.uploadPath=a;i.onloadend=sendEncoded;if(r){i.asyncHandler=r}i.onerror=function(e){r.fault(e)};i.readAsDataURL(n);if(!r){return true}}catch(o){console.log(o)}},upload:function(e,t,n,s){e=e.files||e;var r=this.restUrl+"/"+t+"/";var a="";if(Utils.isBoolean(n)){a="?overwrite="+n}if(isBrowser){if(window.File&&window.FileList){if(e instanceof File){e=[e]}var i=0;for(var o=0,c=e.length;o<c;o++){try{var l=new FileReader;l.fileName=encodeURIComponent(e[o].name).replace(/'/g,"%27").replace(/"/g,"%22");l.uploadPath=r+l.fileName+a;l.onloadend=send;l.asyncHandler=s;l.onerror=function(e){s.fault(e)};l.readAsBinaryString(e[o])}catch(u){i++}}}else{var d=document.createElement("iframe");d.id=d.name="ifr"+getNow();d.width=d.height="0";document.body.appendChild(d);var f=document.createElement("form");f.target=d.name;f.enctype="multipart/form-data";f.method="POST";document.body.appendChild(f);f.appendChild(e);var h=encodeURIComponent(e.value).replace(/'/g,"%27").replace(/"/g,"%22"),p=h.lastIndexOf("\\");if(p){h=h.substring(p+1)}f.action=r+h+a;f.submit()}}else{throw"Upload File not supported with NodeJS"}},listing:function(e,t,n,s,r,a){var i=extractResponder(arguments),o=i!=null,c=this.restUrl+"/"+e;if(arguments.length>1&&!(arguments[1]instanceof Backendless.Async)){c+="?"}if(Utils.isString(t)){c+="pattern="+t}if(Utils.isBoolean(n)){c+="&sub="+n}if(Utils.isNumber(s)){c+="&pagesize="+s}if(Utils.isNumber(r)){c+="&offset="+r}return Backendless._ajax({method:"GET",url:c,isAsync:o,asyncHandler:i})},renameFile:function(e,t,n){this._checkPath(e);var s={oldPathName:e,newName:t};return this._doAction("rename",s,n)},moveFile:function(e,t,n){this._checkPath(e);this._checkPath(t);var s={sourcePath:e,targetPath:t};return this._doAction("move",s,n)},copyFile:function(e,t,n){this._checkPath(e);this._checkPath(t);var s={sourcePath:e,targetPath:t};return this._doAction("copy",s,n)},_checkPath:function(e){if(!/^\//.test(e)){e="/"+e}return e},_doAction:function(e,t,n){var s=extractResponder(arguments);var r=s!=null;return Backendless._ajax({method:"PUT",url:this.restUrl+"/"+e,data:JSON.stringify(t),isAsync:r,asyncHandler:s})},remove:function(e,t){var n=extractResponder(arguments);var s=n!=null;var r=e.indexOf("http://")===0||e.indexOf("https://")===0?e:this.restUrl+"/"+e;Backendless._ajax({method:"DELETE",url:r,isAsync:s,asyncHandler:n})},exists:function(e,t){if(!e||!Utils.isString(e)){throw new Error('Missing value for the "path" argument. The argument must contain a string value')}var n=extractResponder(arguments),s=n!=null,r=this.restUrl+"/exists/"+e;return Backendless._ajax({method:"GET",url:r,isAsync:s,asyncHandler:n})},removeDirectory:function(e,t){var n=extractResponder(arguments);var s=n!=null;return Backendless._ajax({method:"DELETE",url:this.restUrl+"/"+e,isAsync:s,asyncHandler:n})}};function Commerce(){this.restUrl=Backendless.appPath+"/commerce/googleplay"}Commerce.prototype._wrapAsync=function(e){var t=function(t){e.success(t)},n=function(t){e.fault(t)};return new Async(t,n)};Commerce.prototype.validatePlayPurchase=function(e,t,n,s){if(arguments.length<3){throw new Error("Package Name, Product Id, Token must be provided and must be not an empty STRING!")}for(var r=arguments.length-2;r>=0;r--){if(!arguments[r]||!Utils.isString(arguments[r])){throw new Error("Package Name, Product Id, Token must be provided and must be not an empty STRING!")}}var a=extractResponder(arguments),i=a!=null;if(a){a=this._wrapAsync(a)}return Backendless._ajax({method:"GET",url:this.restUrl+"/validate/"+e+"/inapp/"+t+"/purchases/"+n,isAsync:i,asyncHandler:a})};Commerce.prototype.cancelPlaySubscription=function(e,t,n,s){if(arguments.length<3){throw new Error("Package Name, Subscription Id, Token must be provided and must be not an empty STRING!")}for(var r=arguments.length-2;r>=0;r--){if(!arguments[r]||!Utils.isString(arguments[r])){throw new Error("Package Name, Subscription Id, Token must be provided and must be not an empty STRING!");

}}var a=extractResponder(arguments),i=a!=null;if(a){a=this._wrapAsync(a)}return Backendless._ajax({method:"POST",url:this.restUrl+"/"+e+"/subscription/"+t+"/purchases/"+n+"/cancel",isAsync:i,asyncHandler:a})};Commerce.prototype.getPlaySubscriptionStatus=function(e,t,n,s){if(arguments.length<3){throw new Error("Package Name, Subscription Id, Token must be provided and must be not an empty STRING!")}for(var r=arguments.length-2;r>=0;r--){if(!arguments[r]||!Utils.isString(arguments[r])){throw new Error("Package Name, Subscription Id, Token must be provided and must be not an empty STRING!")}}var a=extractResponder(arguments),i=a!=null;if(a){a=this._wrapAsync(a)}return Backendless._ajax({method:"GET",url:this.restUrl+"/"+e+"/subscription/"+t+"/purchases/"+n,isAsync:i,asyncHandler:a})};function Events(){this.restUrl=Backendless.appPath+"/servercode/events"}Events.prototype._wrapAsync=function(e){var t=function(t){e.success(t)},n=function(t){e.fault(t)};return new Async(t,n)};Events.prototype.dispatch=function(e,t,n){if(!e||!Utils.isString(e)){throw new Error("Event Name must be provided and must be not an empty STRING!")}t=Utils.isObject(t)?t:{};var s=extractResponder(arguments),r=s!=null;if(s){s=this._wrapAsync(s)}t=t instanceof Backendless.Async?{}:t;return Backendless._ajax({method:"POST",url:this.restUrl+"/"+e,data:JSON.stringify(t),isAsync:r,asyncHandler:s})};var Cache=function(){};var FactoryMethods={};Cache.prototype={_wrapAsync:function(e,t){var n=this,s=function(s){s=t?t(s):n._parseResponse(s);e.success(s)},r=function(t){e.fault(t)};return new Async(s,r)},_parseResponse:function(e){return e},put:function(e,t,n,s){if(!Utils.isString(e)){throw new Error("You can use only String as key to put into Cache")}if(!(n instanceof Backendless.Async)){if(typeof n=="object"&&!arguments[3]){s=n;n=null}else if(typeof n!=("number"||"string")&&n!=null){throw new Error("You can use only String as timeToLive attribute to put into Cache")}}else{s=n;n=null}if(Utils.isObject(t)&&t.constructor!==Object){t.___class=t.___class||getClassName.call(t)}var r=extractResponder([s]),a=false;if(r!=null){a=true;r=this._wrapAsync(r)}return Backendless._ajax({method:"PUT",url:Backendless.serverURL+"/"+Backendless.appVersion+"/cache/"+e+(n?"?timeout="+n:""),data:JSON.stringify(t),isAsync:a,asyncHandler:r})},expireIn:function(e,t,n){if(Utils.isString(e)&&(Utils.isNumber(t)||Utils.isDate(t))&&t){t=Utils.isDate(t)?t.getTime():t;var s=extractResponder(arguments),r=false;if(s!=null){r=true;s=this._wrapAsync(s)}return Backendless._ajax({method:"PUT",url:Backendless.serverURL+"/"+Backendless.appVersion+"/cache/"+e+"/expireIn?timeout="+t,data:JSON.stringify({}),isAsync:r,asyncHandler:s})}else{throw new Error('The "key" argument must be String. The "seconds" argument can be either Number or Date')}},expireAt:function(e,t,n){if(Utils.isString(e)&&(Utils.isNumber(t)||Utils.isDate(t))&&t){t=Utils.isDate(t)?t.getTime():t;var s=extractResponder(arguments),r=false;if(s!=null){r=true;s=this._wrapAsync(s)}return Backendless._ajax({method:"PUT",url:Backendless.serverURL+"/"+Backendless.appVersion+"/cache/"+e+"/expireAt?timestamp="+t,data:JSON.stringify({}),isAsync:r,asyncHandler:s})}else{throw new Error("You can use only String as key while expire in Cache. Second attribute must be declared and must be a Number or Date type")}},cacheMethod:function(e,t,n,s){if(!Utils.isString(t)){throw new Error('The "key" argument must be String')}var r=extractResponder(arguments),a=false;if(r!=null){a=true;r=this._wrapAsync(r)}return Backendless._ajax({method:e,url:Backendless.serverURL+"/"+Backendless.appVersion+"/cache/"+t+(n?"/check":""),isAsync:a,asyncHandler:r})},contains:function(e,t){return this.cacheMethod("GET",e,true,t)},get:function(e,t){if(!Utils.isString(e)){throw new Error('The "key" argument must be String')}function n(e){var t=e&&e.___class;if(t){var n=FactoryMethods[t]||root[t];if(n){e=new n(e)}}return e}var s=extractResponder(arguments),r=false;if(s!=null){r=true;s=this._wrapAsync(s,n)}var a=Backendless._ajax({method:"GET",url:Backendless.serverURL+"/"+Backendless.appVersion+"/cache/"+e,isAsync:r,asyncHandler:s});return r?a:n(a)},remove:function(e,t){return this.cacheMethod("DELETE",e,false,t)},setObjectFactory:function(e,t){FactoryMethods[e]=t}};var Counters=function(){};var AtomicInstance=function(e){this.name=e};Counters.prototype={_wrapAsync:function(e){var t=this,n=function(n){n=t._parseResponse(n);e.success(n)},s=function(t){e.fault(t)};return new Async(n,s)},_parseResponse:function(e){return e},of:function(e){return new AtomicInstance(e)},getConstructor:function(){return this},counterNameValidation:function(e){if(!e){throw new Error('Missing value for the "counterName" argument. The argument must contain a string value.')}if(!Utils.isString(e)){throw new Error('Invalid value for the "value" argument. The argument must contain only string values')}this.name=e},implementMethod:function(e,t,n){var s=extractResponder(arguments),r=false;if(s!=null){r=true;s=this._wrapAsync(s)}return Backendless._ajax({method:e,url:Backendless.serverURL+"/"+Backendless.appVersion+"/counters/"+this.name+t,isAsync:r,asyncHandler:s})},incrementAndGet:function(e,t){this.counterNameValidation(e,t);return this.implementMethod("PUT","/increment/get",t)},getAndIncrement:function(e,t){this.counterNameValidation(e,t);return this.implementMethod("PUT","/get/increment",t)},decrementAndGet:function(e,t){this.counterNameValidation(e,t);return this.implementMethod("PUT","/decrement/get",t)},getAndDecrement:function(e,t){this.counterNameValidation(e,t);return this.implementMethod("PUT","/get/decrement",t)},reset:function(e,t){this.counterNameValidation(e,t);return this.implementMethod("PUT","/reset",t)},get:function(e,t){this.counterNameValidation(e,t);var n=extractResponder(arguments),s=false;if(n!=null){s=true;n=this._wrapAsync(n)}return Backendless._ajax({method:"GET",url:Backendless.serverURL+"/"+Backendless.appVersion+"/counters/"+this.name,isAsync:s,asyncHandler:n})},implementMethodWithValue:function(e,t,n){if(!t){throw new Error('Missing value for the "value" argument. The argument must contain a numeric value.')}if(!Utils.isNumber(t)){throw new Error('Invalid value for the "value" argument. The argument must contain only numeric values')}var s=extractResponder(arguments),r=false;if(s!=null){r=true;s=this._wrapAsync(s)}return Backendless._ajax({method:"PUT",url:Backendless.serverURL+"/"+Backendless.appVersion+"/counters/"+this.name+e+(t?t:""),isAsync:r,asyncHandler:s})},addAndGet:function(e,t,n){this.counterNameValidation(e,n);return this.implementMethodWithValue("/get/incrementby?value=",t,n)},getAndAdd:function(e,t,n){this.counterNameValidation(e,n);return this.implementMethodWithValue("/incrementby/get?value=",t,n)},compareAndSet:function(e,t,n,s){this.counterNameValidation(e,s);if(!t||!n){throw new Error('Missing values for the "expected" and/or "updated" arguments. The arguments must contain numeric values')}if(!Utils.isNumber(t)||!Utils.isNumber(n)){throw new Error('Missing value for the "expected" and/or "updated" arguments. The arguments must contain a numeric value')}var r=extractResponder(arguments),a=false;if(r!=null){a=true;r=this._wrapAsync(r)}return Backendless._ajax({method:"PUT",url:Backendless.serverURL+"/"+Backendless.appVersion+"/counters/"+this.name+"/get/compareandset?expected="+(t&&n?t+"&updatedvalue="+n:""),isAsync:a,asyncHandler:r})}};AtomicInstance.prototype={incrementAndGet:function(e){return Counters.prototype.getConstructor().incrementAndGet(this.name,e)},getAndIncrement:function(e){return Counters.prototype.getConstructor().getAndIncrement(this.name,e)},decrementAndGet:function(e){return Counters.prototype.getConstructor().decrementAndGet(this.name,e)},getAndDecrement:function(e){return Counters.prototype.getConstructor().getAndDecrement(this.name,e)},reset:function(e){return Counters.prototype.getConstructor().reset(this.name,e)},get:function(e){return Counters.prototype.getConstructor().get(this.name,e)},addAndGet:function(e,t){return Counters.prototype.getConstructor().addAndGet(this.name,e,t)},getAndAdd:function(e,t){return Counters.prototype.getConstructor().getAndAdd(this.name,e,t)},compareAndSet:function(e,t,n){return Counters.prototype.getConstructor().getAndAdd(this.name,e,t,n)}};var lastFlushListeners;Backendless.Logging={restUrl:root.url,loggers:{},logInfo:[],messagesCount:0,numOfMessages:10,timeFrequency:1,getLogger:function(e){if(!Utils.isString(e)){throw new Error("Invalid 'loggerName' value. LoggerName must be a string value")}if(!this.loggers[e]){this.loggers[e]=new Logging(e)}return this.loggers[e]},flush:function(){var e=extractResponder(arguments);if(this.logInfo.length){this.flushInterval&&clearTimeout(this.flushInterval);var t;var n=function(e){return function(){for(var n=0;n<t.length;n++){t[n][e].apply(null,arguments)}if(t===lastFlushListeners){lastFlushListeners=null}}};if(e){t=lastFlushListeners=lastFlushListeners?lastFlushListeners.splice(0):[];t.push(e)}Backendless._ajax({method:"PUT",isAsync:!!e,asyncHandler:e&&new Async(n("success"),n("failure")),url:Backendless.serverURL+"/"+Backendless.appVersion+"/log",data:JSON.stringify(this.logInfo)});this.logInfo=[];this.messagesCount=0}else if(e){if(lastFlushListeners){lastFlushListeners.push(e)}else{setTimeout(e.success,0)}}},sendRequest:function(){var e=this;this.flushInterval=setTimeout(function(){e.flush(new Backendless.Async)},this.timeFrequency*1e3)},checkMessagesLen:function(){if(this.messagesCount>this.numOfMessages-1){this.sendRequest()}},setLogReportingPolicy:function(e,t){this.numOfMessages=e;this.timeFrequency=t;this.checkMessagesLen()}};function Logging(e){this.name=e}function setLogMessage(e,t,n,s){var r={};r["message"]=n;r["timestamp"]=Date.now();r["exception"]=s?s:null;r["logger"]=e;r["log-level"]=t;Backendless.Logging.logInfo.push(r);Backendless.Logging.messagesCount++;Backendless.Logging.checkMessagesLen()}Logging.prototype={debug:function(e){return setLogMessage(this.name,"DEBUG",e)},info:function(e){return setLogMessage(this.name,"INFO",e)},warn:function(e,t){return setLogMessage(this.name,"WARN",e,t)},error:function(e,t){return setLogMessage(this.name,"ERROR",e,t)},fatal:function(e,t){return setLogMessage(this.name,"FATAL",e,t)},trace:function(e){return setLogMessage(this.name,"TRACE",e)}};function CustomServices(){}CustomServices.prototype={invoke:function(e,t,n,s,r){var a=extractResponder(arguments),i=a!=null;return Backendless._ajax({method:"POST",url:Backendless.serverURL+"/"+Backendless.appVersion+"/services/"+e+"/"+t+"/"+n,data:JSON.stringify(s),isAsync:i,asyncHandler:a})}};function promisify(e){return function(){var t=this;var n=[].slice.call(arguments);return new Promise(function(s,r){n.push(new Async(s,r,t));e.apply(t,n)})}}function promisifyPack(e){var t=e[0];var n=e[1];n.forEach(function(e){t[e]=promisify(t[e])})}function enablePromises(){if(promisesEnabled){return}if(typeof Promise==="undefined"){throw new Error("Promises are not supported by your browser. "+'Please use "Backendless.Async" to make async requests, '+"or upgrade to a modern browser.\nSee "+"http://caniuse.com/#feat=promises")}promisesEnabled=true;[[DataPermissions.prototype.FIND,Object.keys(DataPermissions.prototype.FIND)],[DataPermissions.prototype.REMOVE,Object.keys(DataPermissions.prototype.REMOVE)],[DataPermissions.prototype.UPDATE,Object.keys(DataPermissions.prototype.UPDATE)],[Files.prototype,["saveFile","upload","listing","_doAction","remove","exists","removeDirectory"]],[Commerce.prototype,["validatePlayPurchase","cancelPlaySubscription","getPlaySubscriptionStatus"]],[Counters.prototype,["implementMethod","get","implementMethodWithValue","compareAndSet"]],[DataStore.prototype,["save","remove","find","findById","loadRelations"]],[Cache.prototype,["put","expireIn","expireAt","cacheMethod","get"]],[persistence,["describe","getView","callStoredProcedure"]],[FilePermissions.prototype,["sendRequest"]],[CustomServices.prototype,["invoke"]],[Events.prototype,["dispatch"]],[PollingProxy.prototype,["poll"]],[Backendless.Logging,["flush"]],[Messaging.prototype,["publish","sendEmail","cancel","subscribe","registerDevice","getRegistrations","unregisterDevice"]],[Geo.prototype,["addPoint","findUtil","loadMetadata","getClusterPoints","addCategory","getCategories","deleteCategory","deletePoint"]],[UserService.prototype,["register","getUserRoles","roleHelper","login","describeUserClass","restorePassword","logout","update","isValidLogin","loginWithFacebookSdk","loginWithGooglePlusSdk"]]].forEach(promisifyPack);UserService.prototype.getCurrentUser=function(){if(currentUser){return Promise.resolve(currentUser)}else if(Backendless.LocalCache.get("stayLoggedIn")){var e=Backendless.LocalCache.get("current-user-id");return Backendless.Data.of(Backendless.User).findById(e)}else{return Promise.resolve(null)}};UserService.prototype.isValidLogin=function(){var e=Backendless.LocalCache.get("user-token");if(e){return new Promise(function(t,n){return Backendless._ajax({method:"GET",url:Backendless.serverURL+"/"+Backendless.appVersion+"/users/isvalidusertoken/"+e,isAsync:true,asyncHandler:new Async(t,n)})})}return Backendless.UserService.getCurrentUser().then(function(e){return Promise.resolve(!!e)}).catch(function(){return Promise.resolve(false)})}}Backendless.initApp=function(e,t,n){Backendless.applicationId=e;Backendless.secretKey=t;Backendless.appVersion=n;Backendless.appPath=[Backendless.serverURL,Backendless.appVersion].join("/");Backendless.UserService=new UserService;Backendless.Users=Backendless.UserService;Backendless.Geo=new Geo;Backendless.Persistence=persistence;Backendless.Data=persistence;Backendless.Data.Permissions=new DataPermissions;Backendless.Messaging=new Messaging;Backendless.Files=new Files;Backendless.Files.Permissions=new FilePermissions;Backendless.Commerce=new Commerce;Backendless.Events=new Events;Backendless.Cache=new Cache;Backendless.Counters=new Counters;Backendless.CustomServices=new CustomServices;dataStoreCache={};currentUser=null};var DataQuery=function(){this.properties=[];this.condition=null;this.options=null;this.url=null};DataQuery.prototype={addProperty:function(e){this.properties=this.properties||[];this.properties.push(e)}};var GeoQuery=function(){this.searchRectangle=undefined;this.categories=[];this.includeMetadata=true;this.metadata=undefined;this.condition=undefined;this.relativeFindMetadata=undefined;this.relativeFindPercentThreshold=undefined;this.pageSize=undefined;this.latitude=undefined;this.longitude=undefined;this.radius=undefined;this.units=undefined;this.degreePerPixel=undefined;this.clusterGridSize=undefined};GeoQuery.prototype={addCategory:function(){this.categories=this.categories||[];this.categories.push()},setClusteringParams:function(e,t,n,s){s=s||0;var r=parseFloat(e),a=parseFloat(t),i=parseInt(n),o=parseInt(s);if(!isFinite(r)||r<-180||r>180){throw new Error("The westLongitude value must be a number in the range between -180 and 180")}if(!isFinite(a)||a<-180||a>180){throw new Error("The eastLongitude value must be a number in the range between -180 and 180")}if(!isFinite(i)||i<1){throw new Error("The mapWidth value must be a number greater or equal to 1")}if(!isFinite(o)||o<0){throw new Error("The clusterGridSize value must be a number greater or equal to 0")}var c=a-r;c<0&&(c+=360);this.degreePerPixel=c/i;this.clusterGridSize=o||null}};var GeoPoint=function(){this.___class="GeoPoint";this.categories=undefined;this.latitude=undefined;this.longitude=undefined;this.metadata=undefined;this.objectId=undefined};var GeoCluster=function(){this.categories=undefined;this.latitude=undefined;this.longitude=undefined;this.metadata=undefined;this.objectId=undefined;this.totalPoints=undefined;this.geoQuery=undefined};var PublishOptionsHeaders={MESSAGE_TAG:"message",IOS_ALERT_TAG:"ios-alert",IOS_BADGE_TAG:"ios-badge",IOS_SOUND_TAG:"ios-sound",ANDROID_TICKER_TEXT_TAG:"android-ticker-text",ANDROID_CONTENT_TITLE_TAG:"android-content-title",ANDROID_CONTENT_TEXT_TAG:"android-content-text",ANDROID_ACTION_TAG:"android-action",WP_TYPE_TAG:"wp-type",WP_TITLE_TAG:"wp-title",WP_TOAST_SUBTITLE_TAG:"wp-subtitle",WP_TOAST_PARAMETER_TAG:"wp-parameter",WP_TILE_BACKGROUND_IMAGE:"wp-backgroundImage",WP_TILE_COUNT:"wp-count",WP_TILE_BACK_TITLE:"wp-backTitle",WP_TILE_BACK_BACKGROUND_IMAGE:"wp-backImage",WP_TILE_BACK_CONTENT:"wp-backContent",WP_RAW_DATA:"wp-raw"};var PublishOptions=function(e){e=e||{};this.publisherId=e.publisherId||undefined;this.headers=e.headers||undefined;this.subtopic=e.subtopic||undefined};var DeliveryOptions=function(e){e=e||{};this.pushPolicy=e.pushPolicy||undefined;this.pushBroadcast=e.pushBroadcast||undefined;this.pushSinglecast=e.pushSinglecast||undefined;this.publishAt=e.publishAt||undefined;this.repeatEvery=e.repeatEvery||undefined;this.repeatExpiresAt=e.repeatExpiresAt||undefined};var Bodyparts=function(e){e=e||{};this.textmessage=e.textmessage||undefined;this.htmlmessage=e.htmlmessage||undefined};var SubscriptionOptions=function(e){e=e||{};this.subscriberId=e.subscriberId||undefined;this.subtopic=e.subtopic||undefined;this.selector=e.selector||undefined};Backendless.DataQuery=DataQuery;Backendless.GeoQuery=GeoQuery;Backendless.GeoPoint=GeoPoint;Backendless.GeoCluster=GeoCluster;Backendless.Bodyparts=Bodyparts;Backendless.PublishOptions=PublishOptions;Backendless.DeliveryOptions=DeliveryOptions;Backendless.SubscriptionOptions=SubscriptionOptions;Backendless.PublishOptionsHeaders=PublishOptionsHeaders;root.GeoPoint=Backendless.GeoPoint;root.GeoCluster=Backendless.GeoCluster;root.BackendlessGeoQuery=Backendless.GeoQuery;root.Bodyparts=Backendless.Bodyparts;root.PublishOptions=Backendless.PublishOptions;root.DeliveryOptions=Backendless.DeliveryOptions;root.SubscriptionOptions=Backendless.SubscriptionOptions;root.PublishOptionsHeaders=Backendless.PublishOptionsHeaders;return Backendless});
//# sourceMappingURL=libs/backendless.min.map